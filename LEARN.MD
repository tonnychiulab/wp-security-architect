# 學習日誌：打造 WordPress 資安架構師的旅程
> 這不是一本教科書，而是一本冒險日記。記錄我們如何從零開始，打造一個強大且安全的 WordPress 掃描器。

## 第一章：地基的選擇 (The Foundation)

在我們寫下第一行程式碼之前，我們必須先決定這棟房子的「地基」要怎麼打。在 WordPress 的世界裡，掃描器最大的惡夢不是病毒，而是**「超時 (General Timeout)」**與**「記憶體不足 (Memory Exhaustion)」**。

這就像我們要搬走一座山（掃描成千上萬的檔案）。我們有兩種搬法：

### 選項 A：大力士搬運法 (同步掃描 Synchronous Scan)
這是最直覺的做法。
*   **做法**：寫一個迴圈，一口氣把所有檔案看完。
*   **優點**：程式碼寫起來很簡單，邏輯單純。
*   **缺點 (致命)**：PHP 腳本通常有「30 秒執行限制」。如果你的網站檔案太多，搬到一半時間到了，工人就會被強迫停止，剩下的山就沒人搬了。而且如果檔案太多，記憶體（背包）會裝不下，程式直接崩潰。
*   **結論**：適合小型網站，但對於真正的資安產品來說，這是**不可行**的。

### 選項 B：螞蟻搬家法 (非同步增量掃描 Asynchronous Incremental Scan) - [我們選擇這個]
這是 `SKILL.md` 中指定的高級架構。
*   **做法**：我們不試圖一次搬完整座山。我們把工作切成幾千個「小碎片」。每次只花 2-3 秒，搬運幾顆石頭，然後休息，記錄進度（我搬到哪裡了）。下一隻螞蟻（下一個 Request）再來接手繼續搬。
*   **優點**：
    *   **永不炸站**：因為每次只跑幾秒，伺服器覺得很輕鬆。
    *   **無限延伸**：不管網站有一萬個檔案還是一百萬個檔案，只要時間足夠，螞蟻總能搬完。
*   **缺點**：程式邏輯非常複雜。你需要一個「工頭」來記錄進度（Offset），還要處理「接力棒」的傳遞。

---
**我們的決策**：
為了符合 **「Don't Break the Site (永不炸站)」** 的核心哲學，我們**必須**選擇 **選項 B (螞蟻搬家法)**。雖然這會讓開發難度變高，但這才是專業資安軟體該有的樣子。

## 第二章：安全團隊的三個火槍手 (The Three Musketeers)

為了達成我們的安全目標，我們現在組建了一支包含三個角色的虛擬團隊：

1.  **架構師 (The Architect)**
    *   **任務**: 負責蓋房子、鋪路。確保掃描過程很穩、很快，而且絕不把網站弄垮。
    *   **口頭禪**: "Slow is Smooth, Smooth is Fast." (穩就是快)

2.  **獵人 (The Hunter)**
    *   **任務**: 負責抓「壞人」 (Malware)。像是 Webshell、後門、被加密的木馬。
    *   **技能**: YARA 規則、反混淆、熵值分析。

3.  **審計師 (The Auditor)** [新加入!]
    *   **任務**: 負責抓「笨蛋」 (Vulnerabilities)。像是 SQL Injection、XSS、沒檢查權限的代碼。
    *   **技能**: 檢查代碼邏輯錯誤，確保開發者沒有把鑰匙插在門上。

接下來，我們將由 **架構師** 領軍，先搭建起地基 (Scanning Engine)，再讓 **獵人** 與 **審計師** 進駐工作。
